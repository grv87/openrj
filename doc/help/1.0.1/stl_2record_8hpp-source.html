<head>
 <link href="openrj.css" rel="stylesheet" type="text/css">
</head>

<table width = "100%">
 <tr>
  <td align = "center" valign = "middle">
   <a href = "http://www.cuj.com/"><img src = "cuj_logo.gif" border = "0" width = "155" height = "50" alt = "C/C++ User's Journal" /></a>
  </td>
  <td align = "center" valign = "middle">
   <a href = "http://www.synesis.com.au/"><img src = "syn_head.jpg" border = "0" width = "343" height = "50" alt = "Synesis Software" /></a>
  </td>
  <td align = "center" valign = "middle">
   <a href = "http://stlsoft.org"><img src = "stlsoft200x100.jpg" border = "0" width = "100" height = "50" alt = "STLSoft - ... Robust, Lightweight, Cross-platform, Template Software ..." /></a>
  </td>
<!--
  <td align = "center" valign = "middle">
   <a href = "http://atlstl.org"><img src = "atlstl200x100.jpg" border = "0" width = "100" height = "50" alt = "ATLSTL - where the Standard Template Library meets the Active Template Library" /></a>
  </td>
-->
  <td align = "center" valign = "middle">
   <a href = "http://comstl.org"><img src = "comstl200x100.jpg" border = "0" width = "100" height = "50" alt = "COMSTL - where the Standard Template Library meets the Component Object Model" /></a>
  </td>
<!--
  <td align = "center" valign = "middle">
   <a href = "http://inetstl.org"><img src = "inetstl200x100.jpg" border = "0" width = "100" height = "50" alt = "InetSTL - where the Standard Template Library meets the Internet" /></a>
  </td>
-->
  <td align = "center" valign = "middle">
   <a href = "http://unixstl.org"><img src = "unixstl200x100.jpg" border = "0" width = "100" height = "50" alt = "UNIXSTL - Template Software for the UNIX Operating System" /></a>
  </td>
  <td align = "center" valign = "middle">
   <a href = "http://winstl.org"><img src = "winstl200x100.jpg" border = "0" width = "100" height = "50" alt = "WinSTL - where the Standard Template Library meets the Win32 API" /></a>
  </td>
 </tr>
 <tr>
  <td width = "100%" colspan = "6">
   <hr width = "100%">
  </td>
 </tr>
</table>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a></div>
<h1>include/openrj/stl/record.hpp</h1><pre class="fragment"><div>00001 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00002 <span class="comment"> * File:    record.hpp</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * Purpose: Record class, in the C++ mapping of the Open-RJ library</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * Created: 15th June 2004</span>
00007 <span class="comment"> * Updated: 29th September 2004</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> * Home:    http://openrj.org/</span>
00010 <span class="comment"> *</span>
00011 <span class="comment"> * Copyright (c) 2004, Matthew Wilson and Synesis Software</span>
00012 <span class="comment"> * All rights reserved.</span>
00013 <span class="comment"> *</span>
00014 <span class="comment"> * Redistribution and use in source and binary forms, with or without </span>
00015 <span class="comment"> * modification, are permitted provided that the following conditions are met:</span>
00016 <span class="comment"> *</span>
00017 <span class="comment"> * - Redistributions of source code must retain the above copyright notice, this</span>
00018 <span class="comment"> *   list of conditions and the following disclaimer. </span>
00019 <span class="comment"> * - Redistributions in binary form must reproduce the above copyright notice,</span>
00020 <span class="comment"> *   this list of conditions and the following disclaimer in the documentation</span>
00021 <span class="comment"> *   and/or other materials provided with the distribution.</span>
00022 <span class="comment"> * - Neither the names of Matthew Wilson and Synesis Software nor the names of</span>
00023 <span class="comment"> *   any contributors may be used to endorse or promote products derived from</span>
00024 <span class="comment"> *   this software without specific prior written permission.</span>
00025 <span class="comment"> *</span>
00026 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span>
00027 <span class="comment"> * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00028 <span class="comment"> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
00029 <span class="comment"> * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</span>
00030 <span class="comment"> * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
00031 <span class="comment"> * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
00032 <span class="comment"> * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
00033 <span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
00034 <span class="comment"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
00035 <span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
00036 <span class="comment"> * POSSIBILITY OF SUCH DAMAGE.</span>
00037 <span class="comment"> *</span>
00038 <span class="comment"> * ////////////////////////////////////////////////////////////////////////// */</span>
00039 
00040 
00041 <span class="comment">/* \file openrj/stl/record.hpp Record class, in the C++ mapping of the Open-RJ library</span>
00042 <span class="comment"> *</span>
00043 <span class="comment"> */</span>
00044 
00045 <span class="preprocessor">#ifndef OPENRJ_INCL_OPENRJ_STL_H_RECORD</span>
00046 <span class="preprocessor"></span><span class="preprocessor">#define OPENRJ_INCL_OPENRJ_STL_H_RECORD</span>
00047 <span class="preprocessor"></span>
00048 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00049 <span class="comment"> * Version information</span>
00050 <span class="comment"> */</span>
00051 
00052 <span class="preprocessor">#ifndef OPENRJ_DOCUMENTATION_SKIP_SECTION</span>
00053 <span class="preprocessor"></span><span class="preprocessor"># define OPENRJ_VER_OPENRJ_STL_H_RECORD_MAJOR       1</span>
00054 <span class="preprocessor"></span><span class="preprocessor"># define OPENRJ_VER_OPENRJ_STL_H_RECORD_MINOR       1</span>
00055 <span class="preprocessor"></span><span class="preprocessor"># define OPENRJ_VER_OPENRJ_STL_H_RECORD_REVISION    2</span>
00056 <span class="preprocessor"></span><span class="preprocessor"># define OPENRJ_VER_OPENRJ_STL_H_RECORD_EDIT        4</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* !OPENRJ_DOCUMENTATION_SKIP_SECTION */</span>
00058 
00059 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00060 <span class="comment"> * Includes</span>
00061 <span class="comment"> */</span>
00062 
00063 <span class="preprocessor">#include &lt;openrj/openrj.h&gt;</span>
00064 <span class="preprocessor">#include &lt;openrj/openrj_assert.h&gt;</span>
00065 
00066 <span class="preprocessor">#if defined(ORJ_NO_EXCEPTIONS)</span>
00067 <span class="preprocessor"></span><span class="preprocessor"># error The Open-RJ STL mapping is not compilable in the absence of exception</span>
00068 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* ORJ_NO_EXCEPTIONS */</span>
00069 
00070 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00071 <span class="preprocessor">#include &lt;iterator&gt;</span>
00072 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
00073 
00074 <span class="preprocessor">#include &lt;stlsoft_iterator.h&gt;</span>
00075 
00076 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00077 <span class="comment"> * Compiler warnings</span>
00078 <span class="comment"> */</span>
00079 
00080 <span class="preprocessor">#ifdef __BORLANDC__</span>
00081 <span class="preprocessor"></span><span class="preprocessor"># pragma warn -8027</span>
00082 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* __BORLANDC__ */</span>
00083 
00084 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00085 <span class="comment"> * Namespace</span>
00086 <span class="comment"> */</span>
00087 
00088 <span class="keyword">namespace </span>openrj
00089 {
00090 
00091 <span class="keyword">namespace </span>stl
00092 {
00093 
00094 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00095 <span class="comment"> * Classes</span>
00096 <span class="comment"> */</span>
00097 
<a name="l00099"></a><a class="code" href="classopenrj_1_1stl_1_1record.html">00099</a> <span class="keyword">class </span><a class="code" href="classopenrj_1_1stl_1_1record.html">record</a>
00100 {
00101 <span class="keyword">public</span>:
00102     <span class="keyword">typedef</span> <a class="code" href="classopenrj_1_1stl_1_1record.html">record</a>              <a class="code" href="classopenrj_1_1stl_1_1record.html">class_type</a>;
00103     <span class="keyword">typedef</span> <a class="code" href="classopenrj_1_1stl_1_1field.html">field</a>               <a class="code" href="classopenrj_1_1stl_1_1field.html">value_type</a>;
00104     <span class="keyword">typedef</span> <a class="code" href="classopenrj_1_1stl_1_1field.html">value_type</a> <span class="keyword">const</span>    const_reference;
00105     <span class="keyword">typedef</span> <a class="code" href="classopenrj_1_1stl_1_1field.html">value_type</a> <span class="keyword">const</span>    *const_pointer;
00106     <span class="keyword">typedef</span> size_t              distance_type;
00107 
00108 <span class="keyword">public</span>:
00109     <span class="keyword">class </span>const_iterator
00110         : <span class="keyword">public</span> stlsoft::iterator_base&lt;std::random_access_iterator_tag, const value_type, distance_type, const_pointer, const_reference&gt;
00111     {
00112     <span class="keyword">public</span>:
00113         <span class="keyword">typedef</span> <a class="code" href="classopenrj_1_1stl_1_1field.html">field</a>               <a class="code" href="classopenrj_1_1stl_1_1field.html">value_type</a>;
00114 
00115     <span class="keyword">private</span>:
00116         <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classopenrj_1_1stl_1_1record.html">record</a>;
00117 
00118         const_iterator(<a class="code" href="structopenrj_1_1_o_r_j_field_a.html">ORJFieldA</a> <span class="keyword">const</span> *<a class="code" href="classopenrj_1_1stl_1_1field.html">field</a>)
00119             : m_field(field)
00120         {}
00121     <span class="keyword">public</span>:
00122         const_iterator()
00123             : m_field(NULL)
00124         {}
00125         const_iterator(const_iterator <span class="keyword">const</span> &amp;rhs)
00126             : m_field(rhs.m_field)
00127         {}
00128 
00129         const_iterator &amp;operator =(const_iterator <span class="keyword">const</span> &amp;rhs)
00130         {
00131             m_field = rhs.m_field;
00132 
00133             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00134         }
00135 
00136     <span class="keyword">public</span>:
00137 <span class="preprocessor">#ifdef OPENRJ_STL_ITERATOR_HOLDS_VALUE</span>
00138 <span class="preprocessor"></span>        const_reference operator *()<span class="keyword"> const</span>
00139 <span class="keyword">        </span>{
00140             m_value = <a class="code" href="classopenrj_1_1stl_1_1field.html">value_type</a>(m_field);
00141 
00142             <span class="keywordflow">return</span> m_value;
00143 <span class="preprocessor">#else </span><span class="comment">/* ? OPENRJ_STL_ITERATOR_HOLDS_VALUE */</span>
00144         value_type operator *()<span class="keyword"> const</span>
00145 <span class="keyword">        </span>{
00146             <span class="keywordflow">return</span> create_field_(m_field);
00147 <span class="preprocessor">#endif </span><span class="comment">/* OPENRJ_STL_ITERATOR_HOLDS_VALUE */</span>
00148         }
00149         const_iterator &amp;operator ++()
00150         {
00151             ++m_field;
00152 
00153             <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00154         }
00155         const_iterator operator ++(<span class="keywordtype">int</span>)
00156         {
00157             const_iterator  ret(*<span class="keyword">this</span>);
00158 
00159             operator ++();
00160 
00161             <span class="keywordflow">return</span> ret;
00162         }
00163 
00164     <span class="keyword">public</span>:
00165         const_iterator operator -(difference_type d)<span class="keyword"> const</span>
00166 <span class="keyword">        </span>{
00167             <span class="keywordflow">return</span> const_iterator(&amp;m_field[d]);
00168         }
00169         difference_type operator -(const_iterator <span class="keyword">const</span> &amp;rhs)<span class="keyword"> const</span>
00170 <span class="keyword">        </span>{
00171             <span class="keywordflow">return</span> &amp;rhs.m_field[0] - &amp;m_field[0];
00172         }
00173 
00174     <span class="keyword">public</span>:
00175         <span class="keywordtype">bool</span> is_equal(const_iterator <span class="keyword">const</span> &amp;rhs)<span class="keyword"> const</span>
00176 <span class="keyword">        </span>{
00177             <span class="keywordflow">return</span> rhs.m_field == m_field;
00178         }
00179 
00180 <span class="preprocessor">#if defined(__BORLANDC__) || \</span>
00181 <span class="preprocessor">    defined(__DMC__)</span>
00182 <span class="preprocessor"></span>        <span class="keywordtype">bool</span> operator ==(const_iterator <span class="keyword">const</span> &amp;rhs)
00183         {
00184             <span class="keywordflow">return</span> is_equal(rhs);
00185         }
00186 
00187         <span class="keywordtype">bool</span> operator !=(const_iterator <span class="keyword">const</span> &amp;rhs)
00188         {
00189             <span class="keywordflow">return</span> !is_equal(rhs);
00190         }
00191 <span class="preprocessor">#endif </span><span class="comment">/* compiler */</span>
00192 
00193     <span class="keyword">private</span>:
00194         <a class="code" href="structopenrj_1_1_o_r_j_field_a.html">ORJFieldA</a> <span class="keyword">const</span>     *m_field;
00195 <span class="preprocessor">#ifdef OPENRJ_STL_ITERATOR_HOLDS_VALUE</span>
00196 <span class="preprocessor"></span>        <span class="keyword">mutable</span> value_type  m_value;
00197 <span class="preprocessor">#endif </span><span class="comment">/* OPENRJ_STL_ITERATOR_HOLDS_VALUE */</span>
00198     };
00199 
00200     <span class="keyword">friend</span> <span class="keyword">class </span>const_iterator;
00201 
00202 <span class="keyword">public</span>:
<a name="l00204"></a><a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda0">00204</a>     <a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda1">record</a>(<a class="code" href="structopenrj_1_1_o_r_j_record_a.html">ORJRecord</a> <span class="keyword">const</span> *<a class="code" href="classopenrj_1_1stl_1_1record.html">record</a>)
00205         : m_record(record)
00206     {}
<a name="l00208"></a><a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda1">00208</a>     <a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda1">record</a>()
00209         : m_record(NULL)
00210     {}
<a name="l00212"></a><a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda2">00212</a>     <a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda1">record</a>(<a class="code" href="classopenrj_1_1stl_1_1record.html">record</a> <span class="keyword">const</span> &amp;rhs)
00213         : m_record(rhs.m_record)
00214     {}
00215 
<a name="l00217"></a><a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda3">00217</a>     <a class="code" href="classopenrj_1_1stl_1_1record.html">record</a> &amp;operator =(<a class="code" href="classopenrj_1_1stl_1_1record.html">record</a> <span class="keyword">const</span> &amp;rhs)
00218     {
00219         m_record = rhs.<a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recordr0">m_record</a>;
00220 
00221         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00222     }
00223 
00224 <span class="keyword">public</span>:
<a name="l00226"></a><a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda4">00226</a>     size_t <a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda4">size</a>()<span class="keyword"> const</span>
00227 <span class="keyword">    </span>{
00228         openrj_assert(NULL != m_record);
00229 
00230         <span class="keywordflow">return</span> <a class="code" href="namespaceopenrj.html#a37">ORJ_Record_GetNumFieldsA</a>(m_record);
00231     }
<a name="l00233"></a><a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda5">00233</a>     <span class="keywordtype">bool</span> <a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda5">empty</a>()<span class="keyword"> const</span>
00234 <span class="keyword">    </span>{
00235         <span class="keywordflow">return</span> 0 == <a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda4">size</a>();
00236     }
00237 
<a name="l00242"></a><a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda6">00242</a>     field operator [](size_t index)<span class="keyword"> const</span>
00243 <span class="keyword">    </span>{
00244         openrj_assert(index &lt;= <a class="code" href="classopenrj_1_1stl_1_1record.html#openrj_1_1stl_1_1recorda4">size</a>());
00245 
00246         <span class="keywordflow">return</span> field(&amp;m_record-&gt;fields[index]);
00247     }
00248 
00249     <span class="keywordtype">bool</span> has_field(string_t <span class="keyword">const</span> &amp;name) <span class="keyword">const</span>;
00250 
00251     string_t operator [](string_t <span class="keyword">const</span> &amp;name) <span class="keyword">const</span>; <span class="comment">// throw (std::out_of_range)</span>
00252 
00253 <span class="keyword">public</span>:
00254     const_iterator begin()<span class="keyword"> const</span>
00255 <span class="keyword">    </span>{
00256         openrj_assert(NULL != m_record);
00257 
00258         <span class="keywordflow">return</span> &amp;m_record-&gt;fields[0];
00259     }
00260     const_iterator end()<span class="keyword"> const</span>
00261 <span class="keyword">    </span>{
00262         openrj_assert(NULL != m_record);
00263 
00264         <span class="keywordflow">return</span> &amp;m_record-&gt;fields[m_record-&gt;numFields];
00265     }
00266 
00267 <span class="keyword">private</span>:
00276     <span class="keyword">struct </span>same_name
00277     {
00278     <span class="keyword">public</span>:
00279         same_name()
00280             : m_name()
00281         {}
00282         same_name(string_t <span class="keyword">const</span> &amp;name)
00283             : m_name(name)
00284         {}
00285 
00286     <span class="keyword">public</span>:
00287         <span class="keywordtype">bool</span> operator ()(string_t <span class="keyword">const</span> &amp;lhs, string_t <span class="keyword">const</span> &amp;rhs)<span class="keyword"> const</span>
00288 <span class="keyword">        </span>{
00289             <span class="keywordflow">return</span> lhs &lt; rhs;
00290         }
00291         <span class="keywordtype">bool</span> operator ()(ORJFieldA <span class="keyword">const</span> &amp;lhs, ORJFieldA <span class="keyword">const</span> &amp;rhs)<span class="keyword"> const</span>
00292 <span class="keyword">        </span>{
00293             <span class="keywordflow">return</span> operator ()(string_t(lhs.name.ptr, lhs.name.len), string_t(rhs.name.ptr, rhs.name.len));
00294         }
00295         <span class="keywordtype">bool</span> operator ()(string_t <span class="keyword">const</span> &amp;lhs, ORJFieldA <span class="keyword">const</span> &amp;rhs)<span class="keyword"> const</span>
00296 <span class="keyword">        </span>{
00297             <span class="keywordflow">return</span> operator ()(lhs, string_t(rhs.name.ptr, rhs.name.len));
00298         }
00299         <span class="keywordtype">bool</span> operator ()(ORJFieldA <span class="keyword">const</span> &amp;lhs, string_t <span class="keyword">const</span> &amp;rhs)<span class="keyword"> const</span>
00300 <span class="keyword">        </span>{
00301             <span class="keywordflow">return</span> operator ()(string_t(lhs.name.ptr, lhs.name.len), rhs);
00302         }
00303         <span class="keywordtype">bool</span> operator ()(ORJFieldA <span class="keyword">const</span> &amp;f)<span class="keyword"> const</span>
00304 <span class="keyword">        </span>{
00305             <span class="keywordflow">return</span> m_name == f.name.ptr;
00306         }
00307         <span class="keywordtype">bool</span> operator ()(field <span class="keyword">const</span> &amp;f)<span class="keyword"> const</span>
00308 <span class="keyword">        </span>{
00309             <span class="keywordflow">return</span> m_name == f.name();
00310         }
00311 
00312     <span class="keyword">private</span>:
00313         string_t <span class="keyword">const</span>  m_name;
00314 
00315     <span class="keyword">private</span>:
00316         same_name &amp;operator =(same_name <span class="keyword">const</span> &amp;);
00317     };
00318 
00319 <span class="keyword">private</span>:
00320     <span class="keyword">static</span> field create_field_(ORJFieldA <span class="keyword">const</span> *r)
00321     {
00322         <span class="keywordflow">return</span> field(r);
00323     }
00324 
00325     ORJField <span class="keyword">const</span>  *find_field_(string_t <span class="keyword">const</span> &amp;name) <span class="keyword">const</span>;
00326 
00327 <span class="keyword">private</span>:
00328     ORJRecord <span class="keyword">const</span> *m_record;
00329     size_t          m_flags;
00330 };
00331 
00332 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00333 <span class="comment"> * Operators</span>
00334 <span class="comment"> */</span>
00335 
00336 <span class="preprocessor">#if !defined(__BORLANDC__) &amp;&amp; \</span>
00337 <span class="preprocessor">    !defined(__DMC__)</span>
00338 <span class="preprocessor"></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> operator ==(record::const_iterator <span class="keyword">const</span> &amp;lhs, record::const_iterator <span class="keyword">const</span> &amp;rhs)
00339 {
00340     <span class="keywordflow">return</span> lhs.is_equal(rhs);
00341 }
00342 
00343 <span class="keyword">inline</span> <span class="keywordtype">bool</span> operator !=(record::const_iterator <span class="keyword">const</span> &amp;lhs, record::const_iterator <span class="keyword">const</span> &amp;rhs)
00344 {
00345     <span class="keywordflow">return</span> !lhs.is_equal(rhs);
00346 }
00347 <span class="preprocessor">#endif </span><span class="comment">/* compiler */</span>
00348 
00349 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00350 <span class="comment"> * Implementation</span>
00351 <span class="comment"> */</span>
00352 
00353 <span class="keyword">inline</span> ORJField <span class="keyword">const</span> *record::find_field_(string_t <span class="keyword">const</span> &amp;name)<span class="keyword"> const</span>
00354 <span class="keyword"></span>{
00355     <span class="comment">// We do a boring linear search.</span>
00356     ORJField <span class="keyword">const</span>  *<span class="keyword">const</span>  b           =   &amp;m_record-&gt;fields[0];
00357     ORJField <span class="keyword">const</span>  *<span class="keyword">const</span>  e           =   &amp;m_record-&gt;fields[m_record-&gt;numFields];
00358     ORJField <span class="keyword">const</span>          *it;
00359     ORJDatabase <span class="keyword">const</span>       *database   =   <a class="code" href="namespaceopenrj.html#a40">ORJ_Record_GetDatabaseA</a>(m_record);
00360 
00361     <span class="keywordflow">if</span>(<a class="code" href="namespaceopenrj.html#a53a15">ORJ_FLAG_ORDERFIELDS</a> == (database-&gt;flags &amp; <a class="code" href="namespaceopenrj.html#a53a15">ORJ_FLAG_ORDERFIELDS</a>))
00362     {
00363         <span class="comment">// Ordered, so we can do a binary search</span>
00364         it  =   std::lower_bound(b, e, name, same_name());
00365     }
00366     <span class="keywordflow">else</span>
00367     {
00368         <span class="comment">// Unordered, so we must do a linear search</span>
00369         it  =   std::find_if(b, e, same_name(name));
00370     }
00371 
00372     <span class="keywordflow">if</span>(it == e)
00373     {
00374         it = NULL;
00375     }
00376 
00377     <span class="keywordflow">return</span> it;
00378 }
00379 
00380 <span class="keyword">inline</span> <span class="keywordtype">bool</span> record::has_field(string_t <span class="keyword">const</span> &amp;name)<span class="keyword"> const</span>
00381 <span class="keyword"></span>{
00382     <span class="keywordflow">return</span> NULL != find_field_(name);
00383 }
00384 
00385 <span class="keyword">inline</span> string_t record::operator [](string_t <span class="keyword">const</span> &amp;name) <span class="keyword">const</span> <span class="comment">// throw (std::out_of_range)</span>
00386 {
00387     ORJField <span class="keyword">const</span>  *r  =   find_field_(name);
00388 
00389     <span class="keywordflow">if</span>(NULL == r)
00390     {
00391         <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">"record does not contain field named \""</span> + name + <span class="stringliteral">"\""</span>);
00392     }
00393 
00394     <span class="keywordflow">return</span> field(&amp;*r).value();
00395 }
00396 
00397 <span class="comment">/* /////////////////////////////////////////////////////////////////////////////</span>
00398 <span class="comment"> * Namespace</span>
00399 <span class="comment"> */</span>
00400 
00401 } <span class="comment">// namespace stl</span>
00402 } <span class="comment">// namespace openrj</span>
00403 
00404 <span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span>
00405 
00406 <span class="preprocessor">#endif </span><span class="comment">/* !OPENRJ_INCL_OPENRJ_STL_H_RECORD */</span>
00407 
00408 <span class="comment">/* ////////////////////////////////////////////////////////////////////////// */</span>
</div></pre><table width = "100%">
 <tr>
  <td width = "100%">
   <hr width = "100%">
  </td>
 </tr>
 <tr>
  <td align = "center" valign = "middle">
   <font size = "-1">
    <a href = "http://openrj.org/"><b>Open-RJ</b></a>
    Library documentation 
    <a href = "http://synesis.com.au/">© Synesis Software Pty Ltd, 2004</a>
   </font>
  </td>
 </tr>
</table>
